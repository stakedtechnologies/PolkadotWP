このセクションではシステム全体の設計像を簡潔に説明する。システムの詳細な説明は章を追って解説する。

## 5.1. コンセンサス
relay-chainでは、Polkadotは正当なブロックが同期性のあるByzantine faulttolerant (BFT)アルゴリズムを通して合意される。このアルゴリズムはTendermint [11]によってインスパイアされたものである。そして、副次的にHoneyBadgerBFT [14]に似通っている。後者は任意の不完全性のある
ネットワークインフラで正常に動作する権威者もしくはバリデーターがいれば効率的でfault-tolerantのコンセンサスを提供する。

proof-of-authority (PoA)スタイルのネットワークでは、これだけで十分である。しかし、Polkadotは信頼される権威者や3rdパーティーが存在しない完全にOpenでパブリックな環境ネットワークとしてデプロイが可能であるように設計されている。なので私達にはバリデーターを決定し、正直に動くためにインセンティブ設計する必要がある。なので、PoSベースの選考基準を設ける。

## 5.2. 掛け金を証明する
私達はネットワークに特定のアカウントがいくらの"掛け金"を持っているのかを測る方法があることを想定している。 既存のシステムと比較しやすいように計測する単位を"トークン"とする。この言葉はいくつかの理由で理想的ではない。1つはアカウントに紐付いている値がスカラー値であるとは限らないこと。もう1つは個別のトークンに特有性がないからである。

![Summary](https://github.com/stakedtechnologies/PolkadotWP/blob/master/img/summary.png)

私達は、頻度は高くないが（最大でも1日に1回、もしかすると4半期に1回ほど）Nominated Proof-of-Stake (NPoS)によってバリデーターは選出されることを想定している。Incentivisation can happen through a pro-rata allocation of funds coming from a token base expansion (up to 100%
per year, though more likely around 10%) together with any transaction fees collected. マネタリーベースの膨張は主にインフレーションをもたらすけれども、全てのトークン保有者が参加権をフェアに持つので、時とともに価値がへるという心配をする必要がない。そのことでコンセンサスメカニズムにおけるトークンホルダーの役割を喜んでこなすようになる。トークンの特定の割合がステーキングプロセスのターゲットとなる。効率的なトークンベースの増加（token base expansion）はマーケットベースのメカニズムでこのターゲット値に近づくように調整される。

バリデーターは掛け金によって密接につながっている。バリデーターが掛け金を引き出すことができるのは、バリデーターの責務が終わり時間が経ってからである。（3ヶ月くらい）この長い期間が存在するのは、チェーンのチェックポイントまでバリデーターが将来不正を行った場合罰するためである。報酬額を削減したり、意図的にネットワークを悪化させたり、他のバリデーターに掛け金を渡したりした場合、罰を受けることになる。例えば、バリデーターがフォークした両方のチェーンを承認しようとした場合（しばしばショートレンジアタックと呼ばれる）、後々それが検知され罰せられる。

Long-range “nothing-at-stake” attacks4 are circumvented through a simple “checkpoint” latch which prevents a dangerous chain-reorganisation of more than a particular chain-depth. 新しく同期してきたクライアントが間違ったチェーンに騙さないことを確証するために、バリデーターの掛け金整理のタイミングと同じく定期でハードフォークが行われる。これによって最新のチェックポイントブロックハッシュがクライアントに入る。これは今後、“finite chain length”やジェネシスブロックを定期的にリセットすることによってうまくいくようになる。

## 5.3. Parachainとコレイター
各parachainはrelay-cahinに近いセキュリティー強度を持つ。paracahinのヘッダーはrelay-chainのブロックに格納されており、再編成や2重支払いがないようにしている。これはBitcoinでいうサイドチェーンとマージマイニングと似たセキュリティー保証である。Polkadotではそれに加え、parachainのstate transactionが正当であるという強い保証を提供する。これは、バリデーターが暗号学的にランダムにサブセットに配属されることを通して行われる。parachainごとにサブセットがあるかもしれなければ、blockごとにサブセットはことなるかもしれない。この設定はparacahinのブロックタイムがrelaycahinのブロックタイムと少なくても同じくらい長いことを示している。この分割の詳しい方法はこの論文の対象外である。しかし、RanDAOに似たcommit-revealフレームワーク、もしくは暗号学的に安全なハッシュ下の各parachainブロックに結合したデータに立脚している可能性が高い。

そのようなバリデーターのサブセットは正当だと保証されたparachainのブロック候補を提供することを要求されている。正当性というのは2つの重要なポイントを含む。1つ目は全てのstate transitionsが正確に実行され、全ての参照される外部データが最終的に正当であるということ。
2つ目は、that any data which is extrinsic to its
candidate, such as those external transactions, has sufficiently high availability so that participants are able to
download it and execute the block manually.5 Validators may provide only a “null” block containing no external “transactions” data, but may run the risk of getting a reduced reward if they do. They work alongside
a parachain gossip protocol with collators—individuals
who collate transactions into blocks and provide a noninteractive, zero-knowledge proof that the block constitutes a valid child of its parent (and taking any transaction
fees for their trouble).

parachainのプロトコルにチェーン独自のスパム防止方法を搭載する余地を残している。relay-chainにある“compute-resource metering”もしくは、“transaction fee”という根本的な概念は存在しない。relaychainプロトコルによってこれらが強制されることもない。（しかし、堅牢なメカニズムの用意されていないparachainをステークホルダーが採用することは起こりえないだろう）これはEthereumのようなチェーンと明確に異っている。（例：シンプルなfeeモデルを持つBitcoinのようなチェーンもしくは、スパム防止モデルは提唱されていないがそれ以外）

Polkadotのrelay-chainそれ自体はEtheruemのようなaccounts、stateチェーンとして存在する可能性が高い。もしかすると、EVMの派生系であるかもしれない。relay-cahinのノードはかなりの処理能力、トランザクションスループットが要求されるので、トランザクションスループットは高いトランザクション手数料とブロックサイズリミットによって最小化されるだろう。

## 5.4. インターチェーンコミュニケーション
Polkadotの重要な最後の要素は、インターチェーンコミュニケーションである。 paracahin間では幾分かのインフォメーションチャネルが存在するので、Polkadotはスケーラブルなマルチチェーンであると私達は考えている。Polkadotの場合、コミュニケーションはできるだけシンプルに設計している。paracahinで処理されるトランザクションは（Chainのロジックによっては）2つ目のparachainもしくは、relay-cahinに発送することができる。商用的なブロックチェーン上の外部トランザクションのように、トランザクションは完全に非同期であり情報をもとの出処に返し継承することはできない。

![transaction](https://github.com/stakedtechnologies/PolkadotWP/blob/sota/img/transaction.jpg)

実装の複雑性、リスク、将来のparachainアーキテクチャーの制限を最小化する為に、これらのインターチェーントランザクションは一般的な外部トランザクションと区別することができない。トランザクションはparacahinを認識することができるオリジナルの要素と任意のサイズのアドレスを持つ。BitcoinやEthereumといった現在の一般的なシステムとは異なり、インターチェーントランザクションでは料金が紐づく"決済"はできない。そのような決済は発生源と目的地のparachain間のネゴシエーションロジックを通して管理されなければならない。Ethereum’s Serenityで提案されているシステムはそのようなクロスチェーン決済を管理する簡単な方法である。

インターチェーントランザクションは正確性を保証するMarkle treeベースの単純な行列メカニズムを使うことによって解決される。1つのparacahinのアウトプット列を目的地のparacahinのインプット列に移動させるのはrelay-cahinのメンテナーの仕事である。その送られたトランザクションはrelay-cahinのトランザクションそれ自体ではなく、relay-chainによって参照される。他のparacahinのトランザクションからparacahinにスパムが送られるのを防ぐために、目的地のインプット列は一番前のブロック列の時よりも大きすぎないようにする必要がある。もしそのインプット列がブロック処理後、大きすぎた場合、それは"仕込まれた"と考えられ、限界値以下に減らさない限り、続くブロックにおいてトランザクションを処理することができなくなる。それらの列はrelay-cahinによって監督され、互いのparachainの状態を監視し合うことができる。なので、不正の目的地にトランザクションが送信された場合、一瞬で報告され目論見は失敗する。(リターンパスが存在しないので、2次トランザクションがこの理由で失敗した場合、オリジナルcallerに報告することができない。他のリカバリー方法が実行される必要がある。） 

## 5.5. PolkadotとEthereum
Ethereumのチューリング完全性により、お互いにインターオペラビリティを持つ可能性が豊富にあると考えている。少なくても、セキュリティを共有することはできると思う。簡単に言うと、私達はPolkadotからのトランザクションはバリデーターによって署名され、Ethereum上で運用することができ、送信先のコントラクトを起動できるということである。
 In the other direction,
we foresee the usage of specially formatted logs (events)
coming from a “break-out contract” to allow a swift verification that a particular message should be forwarded.

## 5.5.1. PolkadotからEthereum
承認投票メカニズムによって決定されたステークホルダーから形成されたバリデータによるBFTコンセンサスメカニズムを通じて、稀にしか変化せずそこまで多くないバリデータで安全
なコンセンサスを得ることができる。合計144のバリデータ、４秒のブロックタイム、900ブロックのファイナリティ（二重投票などの悪意のある行動、処罰、修復）のシステムでは、ブロッは
妥当であると考えられる。９７個の署名(twothirds of 144 plus one)と６０分の検証期間（デポジットとチャレンジなし）で問題がないことが証明されました。Ethereumは144人
の署名者で維持される”break in contract”(侵入契約）をホストすることができる。EVMで ECDSAの回復にかかるガスはわずか3000ガスであるため、検証は（全会一致でなく）
多くのバリデータによって行われるので、Ethereumの基本コストはPolkadotネットワークからくるのは300,000ガス以下であると正しく検証された。-5.5Mでの総ブロックガスの制限
はわずか６％　バリデータの数を増やすと（数十のチェーンを処理するのに必要となるように）必然的にこのコストが増加するが、技術の成熟とインフラの向上に伴い、Ethereumのトラ
ンザクションの帯域幅は徐々に拡大すると予想される。全てのバリデータが関与する必要があるわけではないという事実（例えば、そのようなタスクのために最もステークしたバリデータ
だけが要求される可能性がある）とともに、このメカニズムの限界は合理的に伸びている。このようなバリデータを毎日ローテーションすることを想定すると（これはかなり保守的で毎週ま
たは毎月さえも許容可能）このEthereum転送ブリッジは１日あたり約５４万ガス、現在のガスコストでは45ドル。ブリッジを介して単独で転送された基本的なトランザクションはやく0.11
ドルかかる。コントラクト計算にはもっとコストがかかる。バッファリングしたりトランザクションをまとめることで、侵入承認コストを簡単に共有できトランザクションあたりのコストを大幅に削減できる。20のトランザクションが要求された場合、基本トランザクションの転送コストは約0.01ドルになる。このマルチシグネチャコントラクトモデルに代わる、興味深くて安価な代替手段の一つはmuilti-lateral ownership semanticeを実現するために閾値シグニチャを使用すること。ECDSAの閾値署名方式は計算量が大きくなるがSchnorr署名などの他の方式のものよりは合理的である。Ethereumは今後のMetropolisハードフォークでこのようなスキームを安価に使用できるようにするプリミティブを導入する予定である。そのような手段が利用できれば、PolkadotトランザクションをEthereumネットワークに転送するためのガスコストは大幅に削減され、オーバヘッドはほぼゼロになり、署名を検証しトランザクションを実行する基本的なコストよりは高い。このモデルではPolkadotのバリデータノードはメッセージにサインする以外にほとんど何もする必要がない。Polkadotトランザクションを
Ethereumネットワークに転送するためのガスコストは署名を検証し、基礎となるトランザクションを実行するための基本コストと比べて大幅に削減され、オーバーヘッドはほぼゼロにな
る。
このモデルではPolkadotのバリデータノードは、署名メッセージ以外にほとんど何もする必要がない。トランザクションをEthereumネットワークに実際にルーティングするためには、バリデーター自体もEthereumネットワーク上に存在するか、あるいはもっと可能性が高いのはメッセージをネットワークに転送する最初のアクターに少額の報奨金が提供されるかのいずれ
かを想定する。



## 5.5.2. EthereumからPolkadot
EthereumからPolkadotにトランザクションを転送するには、単純にログの概念を使用する。Ethereumのコントラクトでは、Polkadotの特定のパラチェーンにトランザクションをディ
スパッチする場合、特別な”break-out contrat”を呼び出すだけで済む。”break-out contract”は必要とされる可能性のある全ての支払いを受け取り、マークル証明と対応
するブロックのヘッダが有効かつ正規であるというアサーションによってその存在が証明されるようにロギング命令を発行する。あとの二つの条件のうち、おそらく最も簡単に証明できる
のは有効性である。原則として、各Polkadotノードに必要なのは、標準Ethereumノードの完全に同期されたインスタンスを実行するための証明（すなわち指定されたバリデータノー
ド）だけである。残念ながらこれはこれ自体がかなり強い依存関係である。より軽量な方法は、ブロック内のトランザクションを適切に実行し、ログ（ブロック受信に含まれる）が有効である
ことを確認するために必要なEthereumのstateテストの一部のみを提供することによって、ヘッダが正しく評価されたという簡単な証明を使用すること。このような”SPV-like”6 
proofsはまだかなりの量の情報が必要である。しかし都合の良いことにこうしたヘッダは一般的に全てを必要としない。すなわちもし他の第三者(fisherなど）がヘッダを無効である
ことを証明した場合（具体的にはstate rootまたはreceipt rootが正しくない）polkadot内のボンドシステムによってbondを所有する第三者はbondを失う危険を冒してヘッダ
を提出することができる。Ethereumのようなnon-finalize PoWネットワークでは正規性を完全に証明するのは不可能である。これに対処するために、あらゆる種類のチェーン依存
の原因と結果に依存しようとするアプリケーションはいくつかの”confirmations”を待つか、依存トランザクションがチェーン内のある特定の深さになるまで待つ。Ethereumではこの
深さは既知のネットワークの問題がない場合の最も価値の低いトランザクションの１ブロックから交換用に最初にリリースされたFrontireの場合の1200ブロックまで様々である。安定し
た”Homestead"ネットワークではこの数値はほとんどの交換で120ブロックになり、同様のパラメータをとることになる。したがってPolkadot側Ethereumインターフェースがいくつか
の単純な機能を持つことを想像することができる。：Ethereumネットワークから新しいヘッダーを受け入れ、POWを検証することができ、十分な深さ（対応するメッセージをPolkadot内
で転送する。）のヘッダのためにEthreum側の”break out”コントラクトによって特定のログが出力されたという何らかの証明を受け入れることができ、最後に以前に受け入れられた
がまだ実施されていないヘッダが無効な受信ルートを含むという証明を受け入れることができる。Ethereumヘッダ、データ自体（およびSPVの証明または有効性、妥当性の反論）を実
際にPolkadotネットワークに取り込むには、データ転送のインセンティブが必要である。これはヘッダが有効で有用なブロックを転送できる誰にでも支払われる支払い（Ethereum側で徴収した料金から資金を得た）もののような単純な支払いである可能性がある。バリデータは何らかのプロトコル固有の手段によって、またはリレーチェーン上で維持されるコントラクトによって、フォークを管理することができるうようにするために最後の数千ブロックに関する情報を保持することが求められる。


## 5.6. PolkadotとBitcoin
BitcoinとのインターオペラビリティはPolkadotにとって興味深い挑戦である。いわゆる”two way peg” は両方のネットワーク側にある有用なインフラストラクチャの一部になるだ
ろう。しかしBitcoinの限界のためにこのようなペグを安全に提供することは簡単ではない。BitcoinからPolkadotへの取引は原理的にはEthereumと同様のプロセスで行うことが
できる。Polkadotバリデータによって何らかの方法で制御される”break-out address”は転送されたトークン（データも一緒に送られる）を受け取ることができる。SPVの証明はイ
ンセンティブ化されたオラクルによって提供され、確認期間と共にトランザクションが”二重消費された”ことを示す非正規ブロックを特定するための報奨金が与えられる。その
後、”break-out address”で所有されるトークンは原則として後のdispesal(分散?)のために同じバリデータによって制御される。しかし問題はデポジットをローティングバリデー
タセットから安全に制御する方法である。署名の組み合わせに基づいて任意の決定を行いことができるEthereumとは異なり、Bitcoinは実質的により限定されておりほとんどのクライ
アントは最大３人のパーティーによる複数の署名のトランザクションしか受け付けない。現在のプロトコルではこれを３６、あるいは最終的に数千に拡張することは不可能である。一つの選
択肢はBitcoinプロトコルを変更してそのような機能を可能にすることだが、Bitcoinの世界におけるハードフォークは最近の試みから判断すると調整が難しい。一つの可能性は閾値
署名の使用である。これは単一の識別可能な公開鍵が複数のシークレット”parts”によって効果的に制御されることを可能にする暗号方式であり、そのいくつかまたは全ては有効な署
名を作成するために利用されなければならない。残念なことにBitcoinのECDSAと互換性のある閾値署名は生成するには計算コストがかかり、多項式の複雑さを伴う。Schnorr署名
のような他のスキームははるかに低いコストを提供するが、それらがBitcoinプロトコルに導入される時系列は不確実である。デポジットの最終的なセキュリティは多数のバリデータに
かかっているので、他の一つの選択肢は”multi-signature key-holders”を閾値署名が実現可能になるように全体のバリデータのうちの強固に結合された部分集合のみに減ら
すことである（あるいは最悪の場合、Bitcoinのネイティブマルチシグネイチャは可能だ。）これはもちろんバリデータが不正に行動した場合に賠償金として差し引かれるbondsの総額
を減らすが、これはゆうがな低下であり、単に二つのネットワーク間を安全に走ることができる資金量の上限を設定するだけである（あるいはバリデータからの攻撃が成功した場合の％損
失について）。このように二つのネットワークの間に適度に安全なBitcoinのインターオペラビリティ”virtual parachain”を置くことは非現実ではないと信じておるが、不確実なス
ケジュールでの相当な努力が必要であり、そのネットワーク内のステークホルダーの協力を必要とする可能性が非常に高い。

